
## Methods
Functions for GBP approximations were written natively from the mathmatical formulas described in the paper.
These funcitons were then compared to those presented on the author's github and any differences between the functions
were addressed. These functions were then used to recreate Figures 1-4 and Tables 1-3. Figures 1-3 demonstrate the 
general accuracy of the functions developed while Figure 4 and Tables 1-2 refer to a specific MCMC analysis that 
was performed on the Gambia dataset (dataset described by authors as Gambia). Table 3 refers to a similar analysis that was
performed on the Breast Tumor Dataset in the MixOmics R Package (also described by Authors in the paper). The code used to generate
these figures and tables is located in code/04_figures.R. Since Figures 1-3 are simple function calls, these figures do not require
any additional datasets.

For the Gambia MCMC analysis (located in code/02_gambia.R), we attempted to write our own MCMC function to replicate the MCMC algorithm
described in the paper. However, we were unable to get this function to work. The numbner of priors and the complexity of the model with multiple
parameters affecting each other made it difficult to write an algorithm that achieved adequate mixing. For some reason, the MCMC function that we wrote,
which was a mixture of Metroplis and Gibbs sampling, sent the parameters to W to extemely large values causing R2 to be basically 1. This is not the case in the 
paper and therefore we believe that our MCMC function was incorrect. Therefore, we implemented the JAGS package that was used by the authors
to perform the MCMC analysis. The JAGS package is a well known package for performing MCMC analysis and is widely used in the field. The package allows the user
to write their own JAGS model in JAGS code but substitute parameters from determined by R into the model, and then run then MCMC analysis through Gibbs sampling.
In the JAGS model, all that is required is to define the model, the data, and the initial values. The JAGS package then takes care of the rest ensuring that the MCMC
algorithm is adequately mixed. Since none of the group members were familiar with JAGS, we copied the JAGS code from the authors' github and then substituted the 
parameters that we had determined from our own GBP approximations. The JAGS code was run for 40,000 iterations with a burn-in of 2,500. Additionally, the authors
of the paper ran MCMC analysis on this dataset with two other priors (denoted Vague and PC). These priors are not novel to the paper and serve as
baselines for comparison of the R2D2 prior. Therefore, we did not include computation for these priors in our Figures.

## Figure 1:
This is exactly like the Figure 1 from the table. It is calculated with exact solutions
and therefore deterministic. We expect this figure to exactly match that of the paper if our
functions to determine the exact prior are correct. We can see that they match exactly and therefore
we believe they are correct.

## Figure 2:
This figure has the aim of showing the power of the GBP approximation (as described in Section 3.2.3 of the paper) and how closely it follows the real
density of W in cases where an exact closed-form solution exists. We can see that our Figure 2 almost exactly
matches the Figure 2 in the paper. The third line on the plot show the linear approximation, which is a simple first order Taylor expansion described in 3.2.1.
This figure exactly matches the figure in the paper and therefore we believe that our GBP approximation is correct.

## Table 1:
This table provides the GBP approximation for the Gambia dataset. Over a number of different paramters for a and b. Essentially, this table was produced by running
the GBP approximation function for a number of different values of a and b, while fixing Beta0 in the formula to the Beta0 from the Gambia dataset (which was calculated
by calculating log-odds of the average response). The table is not exactly the same as the one in the paper, but it is very similar. There are minor differences in the values of the
approximations. I am assuming that this is likely due to the fact that this approximation ethod for the GBP parameters includes numberic optimization, which is not exact and 
can vary between runs. The values of the approximations that we have are very similar to the values in the paper, and therefore we believe that our GBP approximation is correct and
any discrepancies are due to the numeric optimization.

## Figure 3:
Figure 3 shows the prior distributions of R^2 and W for the R2D2 prior on the gambia dataset. The first plot shows the prior distribution of R^2 which is a beta distribution
with parameters a and b. Our plot matches the one in the paper exactly for this, which is expected. The second plot shows the prior distribution of W which is 
dertermind by the GBP approximations that we determined in Figure 2. This plot is also very similar to the one in the paper, but not exactly the same as far as the values. 
The differences are likely due to the numeric optimization that we used to determine the GBP approximations.

# Table 2:
Table 2 shows the statistics for the posterior samples for R2, W, random effect variance, and spatial range, that were determined by the JAGS MCMC analysis. The table is not 
exactly the same as the one in the paper, but it is very similar with values being largely in the same range but not always close. I am assuming that this is likely due to the fac
that MCMC algorithms are stochastic and can vary between runs. Additionally, the paper ran their MCMC analysis for 105,000 iterations with a burn-in of 5,000, 
while we ran our MCMC analysis for 40,000 iterations with a burn-in of 2,500. We decided to run our MCMC analysis for a shorter number of iterations and burn-in because 
due to computational constraints as 105,000 samples would have had very long computational time. Between the stochastic nature of the MCMC algorithm and the difference in the 
number of iterations, we believe that our MCMC analysis is correct and any discrepancies are due to these reasons.

# Figure 4:
Figure 4 shows the posterior distributions of R2, W, random effect variance, and spatial range for the Gambia dataset. Overall, our Figure 4 very closely matches the Figure 4
from the paper. The only large difference is the distribution for R2 that is shown to be considerably more symmetric and "normal" in the paper. Alternatively, our densities had
a fair bit more left skewedness, especially for the lower values of a and b. Additionally, our distribition for R2 is much wider than that of the Figure 4 in the paper. The bulk
of the density in the paper lies between 0.15 and 0.2, where the bulk of the density in ours is between 0.15 and 0.45. Other than that, the remaining densities look overall
more similar asto the one's proposed in the paper. Even the unique curvature of the rho density is captured. The densities that we created were a little less smooth than those in
paper. This is expected as we used considerably less iteration in of MCMC algorith which would cause things to be rougher. We also attribute this decreased number of iterations
to the distinctions we are seeing in the posterior for R2. We noticed that the transformation from W to R2 is very senstitive to changes in W, so we are assuming that with these
lower number of iterations, our some of our MCMC samples for W had not fully converged and were still a little futher off in the right tail of the distribution than what the
author's showed. This is the likely cause of the wider and more skewed density.
